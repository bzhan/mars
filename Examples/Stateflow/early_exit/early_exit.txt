P ::= @M || @S1
M ::= skip; num := 0; wait(2); (num == 0 -> (state := ""; E := ""; EL := [""]; NL := [1]; num := 1); num == 1 -> (DState1!state --> skip $ DBC1!E --> skip $ BC1!E --> skip $ BR1?E --> skip; EL := push(EL,E); NL := push(NL,1); num := 1 $ DBR1?E --> skip; DBnum1?Dnum; num := Dnum; DState1?state $ DBO1? --> skip; num := num+1 $ BO1? --> skip; num := num+1; NL := pop(NL); NL := push(NL,num)); num == 2 -> (EL := pop(EL); NL := pop(NL); EL == [] -> (num := 0; wait(2)); EL != [] -> (E := top(EL); num := top(NL))))**
S1 ::= a_Chart := 0; a_Chart_A := 0; a_Chart_A_A1 := 0; a_Chart_A_A2 := 0; a_Chart_B := 0; a_Chart := 1; a_Chart_A := 1; a_Chart_A_A1 := 1; wait(2); skip; (rec X.(BC1?E; skip; if a_Chart_A == 1 then done := 0; E == "e" && done == 0 -> (a_Chart_A_A2 == 1 -> a_Chart_A_A2 := 0; a_Chart_A_A1 == 1 -> a_Chart_A_A1 := 0; a_Chart_A := 0; a_Chart_B := 1; done := 1); done == 0 -> if a_Chart_A_A1 == 1 then done := 0; done == 0 -> (BR1!"e"; @X; a_A1 == 1 -> (a_Chart_A_A1 := 0; a_Chart_A_A2 := 1; done := 1)) elif a_Chart_A_A2 == 1 then skip else skip endif elif a_Chart_B == 1 then skip else skip endif; BO1!; skip); wait(2))**
