P ::= NO_SET := 1; SET := 0; buffer_heartbeat := [0,0,0,0]; count3 := 0; first_SN := 1; last_SN := 2; unsent := [1,1,1,1,1]; y := 0; a_S1 := 0; a_S1 := 1; done := 0; a_S1 := 1; i := first_SN; if done == 0 && i > last_SN then if done == 0 then flag := 1; if done == 0 then skip else skip endif else skip endif elif done == 0 && i <= last_SN && unsent[i] == 0 then if done == 0 then i := i+1; if done == 0 then (if done == 0 then skip else skip endif; if done == 0 && i <= last_SN && unsent[i] == 0 then skip else skip endif; if done == 0 then i := i+1 else skip endif){done == 0 && i <= last_SN && unsent[i] == 0}** else skip endif else skip endif elif done == 0 then if done == 0 then flag := 0; if done == 0 then skip else skip endif else skip endif else skip endif; y := flag; wait(0.1); (done := 0; done == 0 -> (wid := 1; count := 0; done := 0; a_S1 := 1; if count == 3 && done == 0 then if done == 0 then buffer_heartbeat[1] := NO_SET; count1 := 0; if done == 0 then if done == 0 then skip else skip endif else skip endif else skip endif elif done == 0 then buffer_heartbeat[1] := SET; count1 := count+1; if done == 0 then skip else skip endif else skip endif; count3 := count1; skip); wait(0.1))**
